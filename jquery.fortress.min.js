/* Password Meter (fortress) | Version 1.2.1 | http://wesleytodd.com/ */
(function(a){a.fortress=function(c,b){var d=this;d.$el=a(c);d.el=c;d.$el.data("fortress",d);d.init=function(){d.options=a.extend({},a.fortress.defaultOptions,b);if(!d.options.strengthMeterText){d.options.strengthMeterText=a('<span class="fortress-strength-text">'+d.options.textST0+"</span>")}if(!d.options.strengthMeterIndicator){d.options.strengthMeterIndicator=a('<a class="fortress-strength-indicator"></a>')}if(!d.options.strengthMeterWraper){d.options.strengthMeterWraper=a('<div class="fortress-strength-wraper st-0"></div>');d.options.strengthMeterWraper.append(d.options.strengthMeterIndicator).append(d.options.strengthMeterText);d.$el.after(d.options.strengthMeterWraper)}d.attacheListener(d.$el);d.checkPass(d.$el.val())};d.attacheListener=function(e){e.on({keyup:function(f){if(a(this).val()!=d.curVal){d.curVal=a(this).val();d.refresh(d.checkPass(a(this).val()))}},unmaskreplace:function(g,f){d.attacheListener(f);d.$el=f;d.el=f.get(0)}})};d.checkPass=function(e){d.$el.trigger("checkpass",[e]);if(e.length<1){return 0}if(!e.match(d.options.regexST1)){return 1}if(!e.match(d.options.regexST2)){return 2}if(!e.match(d.options.regexST3)){return 3}if(!e.match(d.options.regexST4)){return 4}return 5};d.refresh=function(e){d.options.strengthMeterText.html(d.options["textST"+e]);d.options.strengthMeterWraper.removeClass("st-0 st-1 st-2 st-3 st-4 st-5").addClass("st-"+e);d.$el.addClass("st-"+e)};d.init()};a.fortress.defaultOptions={strengthMeterWraper:false,strengthMeterIndicator:false,strengthMeterText:false,textST0:"Password Strength",textST1:"Very Weak",textST2:"Weak",textST3:"Average",textST4:"Strong",textST5:"Very Strong",regexST1:/^.*(?=.{5,})|(?=.{4,})(?=.*[A-Z\d\W]).*$/,regexST2:/^.*(.*(?=.{5,})(?=.*[a-z])(?=.*[A-Z])(?=.*[\d\W]).*|.*(?=.{7,})(?=.*[A-Z\d\W]).*|.*(?=.{10,}).*).*$/,regexST3:/^.*((?=.{5,})(?=.*[a-z])(?=.*[A-Z])(?=.*[\d\W])|(?=.{10,})(?=.*[a-z])(?=.*[A-Z\d\W]))|(?=.{15,}).*$/,regexST4:/^.*((?=.{7,})(?=.*[a-z])(?=.*[A-Z])(?=.*[\d])(?=.*[\W])|(?=.{12,})(?=.*[a-z])(?=.*[A-Z\d\W])).*$/};a.fn.fortress=function(b){return this.each(function(){(new a.fortress(this,b))})}})(jQuery);